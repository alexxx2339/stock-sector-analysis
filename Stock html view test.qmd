---
---
title: "ğŸ“Š S&P 500 Sector Performance"
author: "Alex Alvarez"
format: html
editor: visual
---

## ğŸ§  Overview

This project analyzes the performance of **S&P 500 sectors** using sector **ETFs** (like XLK for tech, XLE for energy, etc.) from **2015 to July 2025**.\
ğŸ“¥ Data is pulled from Yahoo Finance using R packages `quantmod` and `PerformanceAnalytics`.

### ğŸ” Weâ€™ll explore:

-   ğŸ“ˆ Monthly returns\
-   ğŸ“‰ Cumulative performance\
-   ğŸ” Rolling volatility

### ğŸ§° Tools Used:

-   ğŸ§® `quantmod`: To download stock data\

-   ğŸ“‰ `PerformanceAnalytics`: For return metrics & charts\

-   

    ## ğŸ§¹ `tidyverse`: For data wrangling and visualization

```{r}
library(quantmod)
library(PerformanceAnalytics)
library(tidyverse)

```

```{r}
#create your clean prices object â€” a time-series dataset with all 11 sector ETF prices from 2015 to today (July 25, 2025).

tickers <- c("XLK", "XLE", "XLF", "XLV", "XLY", "XLU", "XLI", "XLB", "XLRE", "XLC", "XLP")

getSymbols(tickers, src = "yahoo", from = "2015-01-01", to = Sys.Date())

prices <- map(tickers, ~ Ad(get(.x))) %>% reduce(merge)
colnames(prices) <- tickers
```

```{r}
# Get monthly closing prices
monthly_prices_list <- map(tickers, ~ {
  to.monthly(get(.x), indexAt = "lastof", drop.time = TRUE)[, 4]
})
monthly_prices <- reduce(monthly_prices_list, merge)
colnames(monthly_prices) <- tickers

# Calculate discrete monthly returns
monthly_returns <- ROC(monthly_prices, type = "discrete") %>% na.omit()

suppressWarnings(
  charts.PerformanceSummary(
    monthly_returns,
    main = "ğŸ“ˆ S&P 500 Sector Monthly Returns (2015â€“2025)"
  )
)
 
```

> **Interpretation:**
>
> -   ğŸ“ˆ **Cumulative Return:** Shows how each sector grew over time.
>
> -   ğŸ“‰ **Monthly Return:** Highlights monthly fluctuations (volatility)
>
> -   ğŸ”» **Drawdown:** Shows the largest drops from peaks â€” useful to evaluate risk.

```{r}
# Clean Comparison with 5 Sectors (Optional for Simplicity)
tickers <- c("XLK", "XLY", "XLE", "XLP", "XLV")

getSymbols(tickers, src = "yahoo", from = "2015-01-01", to = Sys.Date())
prices <- map(tickers, ~ Ad(get(.x))) %>% reduce(merge)
colnames(prices) <- tickers
```

```{r}
summary_stats <- table.Stats(monthly_returns)
round(summary_stats, 5)

```

```{r}
# Apply to.monthly and extract Close for each ticker individually
monthly_prices_list <- map(tickers, ~ {
  to.monthly(get(.x), indexAt = "lastof", drop.time = TRUE)[, 4]  # 4 = Close
})

# Combine into one xts object
monthly_prices <- reduce(monthly_prices_list, merge)
colnames(monthly_prices) <- tickers

# Calculate monthly returns
monthly_returns <- ROC(monthly_prices, type = "discrete") %>% na.omit()

```

```{r}
colnames(table.Stats(monthly_returns))
```

```{r}
summary_stats <- table.Stats(monthly_returns)
round(summary_stats, 4)
```

-   ğŸ“Š **Arithmetic Mean** = average monthly return

<!-- -->

-   âš–ï¸ **Stdev** = volatility (risk)

<!-- -->

-   ğŸš¨ **Minimum** = worst monthly performance

-   ğŸ† **Maximum** = best monthly performance

```         
ğŸ§  Insights

-    ğŸ’¡ Technology (XLK) and Consumer Discretionary (XLY) had the **highest average returns**.

-    âš¡ Energy (XLE) showed **higher volatility** and **largest drawdowns**.

-    ğŸ›¡ï¸ Staples (XLP) and Health Care (XLV) provided **more stability** in downturns.
```

```{r}
suppressWarnings(
  charts.PerformanceSummary(
    monthly_returns,
    main = "S&P 500 Sector Monthly Returns (2015â€“2025)"
  )
) 
```

Conclusion

This project demonstrates how financial data from Yahoo Finance can be used with R to evaluate investment performance across sectors. The combination of cumulative return charts and return statistics helps understand **growth potential** and **risk exposure** across the S&P 500 sectors.

```{r}
# Save chart to file
png("figures/monthly_returns_chart.png", width = 800, height = 600)
charts.PerformanceSummary(monthly_returns, main = "S&P 500 Sector Monthly Returns (2015â€“2025)")
dev.off()
```
